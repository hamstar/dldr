
require "cgi"
require 'digest/md5'

cgi = CGI.new
api = API.new

run_folder = File.dirname(__FILE__) + "/run"

case cgi["action"]

  when "download"
    result = api.download( cgi["url"] )

  when "status"
    result = api.status( cgi["url"] )

  else
    result = { "error" => "Invalid action" }

end

puts JSON.generate( result );